<!DOCTYPE html>
<html>

<head>
  <link rel="icon" href="../icons/favicon.ico" type="image/x-icon">
  <!-- <link rel="stylesheet" href="/login.css"> -->
  <link rel="stylesheet" href="../styles/login_styles/login_general.css">
  <link rel="stylesheet" href="../styles/login_styles/login_input.css">
  <link rel="stylesheet" href="../styles/login_styles/login_introduction.css">
  <title>NGSase_</title>
</head>

<body>
  <div class="pannel">
    <div class="login-leftside">
      <div class="mark">
        <!-- <img
        src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTY5NiIgaGVpZ2h0PSI3NzkiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHhtbDpzcGFjZT0icHJlc2VydmUiIG92ZXJmbG93PSJoaWRkZW4iPjxkZWZzPjxjbGlwUGF0aCBpZD0iY2xpcDAiPjxyZWN0IHg9Ijc2MCIgeT0iNDk1IiB3aWR0aD0iMTY5NiIgaGVpZ2h0PSI3NzkiLz48L2NsaXBQYXRoPjwvZGVmcz48ZyBjbGlwLXBhdGg9InVybCgjY2xpcDApIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNzYwIC00OTUpIj48cGF0aCBkPSJNODk1LjE2NyA5NDcuNUM4NzcuNjc4IDk0Ny41IDg2My41IDkzMy4zMjIgODYzLjUgOTE1LjgzMkw4NjMuNSA3NTYuMTY3Qzg2My41IDczOC42NzggODc3LjY3OCA3MjQuNSA4OTUuMTY3IDcyNC41TDEwMjEuODMgNzI0LjVDMTAzOS4zMiA3MjQuNSAxMDUzLjUgNzM4LjY3OCAxMDUzLjUgNzU2LjE2N0wxMDUzLjUgOTE1LjgzMkMxMDUzLjUgOTMzLjMyMiAxMDM5LjMyIDk0Ny41IDEwMjEuODMgOTQ3LjVaIiBzdHJva2U9IiNEOUQ5RDkiIHN0cm9rZS13aWR0aD0iNDEuMjUiIHN0cm9rZS1saW5lY2FwPSJidXR0IiBzdHJva2UtbGluZWpvaW49Im1pdGVyIiBzdHJva2UtbWl0ZXJsaW1pdD0iOCIgc3Ryb2tlLW9wYWNpdHk9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPjxwYXRoIGQ9Ik05OTEuMDk3IDgzMy44NTYgOTczLjc2MiA4ODUuMjY3Qzk3MS4zNjkgODkyLjM2NSA5NjMuNjc0IDg5Ni4xOCA5NTYuNTc1IDg5My43ODZMODYyLjE0MiA4NjEuOTQ1IDg4OC4xNDQgNzg0LjgyOCA5ODIuNTc4IDgxNi42NjlDOTg5LjY3NiA4MTkuMDYzIDk5My40OSA4MjYuNzU3IDk5MS4wOTcgODMzLjg1NloiIHN0cm9rZT0iI0Q5RDlEOSIgc3Ryb2tlLXdpZHRoPSIxMC4zMTI1IiBzdHJva2UtbGluZWNhcD0iYnV0dCIgc3Ryb2tlLWxpbmVqb2luPSJtaXRlciIgc3Ryb2tlLW1pdGVybGltaXQ9IjgiIHN0cm9rZS1vcGFjaXR5PSIxIiBmaWxsPSIjRDlEOUQ5IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGZpbGwtb3BhY2l0eT0iMSIvPjx0ZXh0IGZpbGw9IiNEOUQ5RDkiIGZpbGwtb3BhY2l0eT0iMSIgZm9udC1mYW1pbHk9IkhlbHZldGljYSBOZXVlLEhlbHZldGljYSBOZXVlX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiIgZm9udC1zdHlsZT0ibm9ybWFsIiBmb250LXZhcmlhbnQ9Im5vcm1hbCIgZm9udC13ZWlnaHQ9IjcwMCIgZm9udC1zdHJldGNoPSJub3JtYWwiIGZvbnQtc2l6ZT0iMzY5IiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGRpcmVjdGlvbj0ibHRyIiB3cml0aW5nLW1vZGU9ImxyLXRiIiB1bmljb2RlLWJpZGk9Im5vcm1hbCIgdGV4dC1kZWNvcmF0aW9uPSJub25lIiB0cmFuc2Zvcm09Im1hdHJpeCgxIDAgMCAxIDEwMDAuOTMgOTY5KSI+TkdTPC90ZXh0Pjx0ZXh0IGZpbGw9IiNEOUQ5RDkiIGZpbGwtb3BhY2l0eT0iMSIgZm9udC1mYW1pbHk9IkhlbHZldGljYSBOZXVlLEhlbHZldGljYSBOZXVlX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiIgZm9udC1zdHlsZT0ibm9ybWFsIiBmb250LXZhcmlhbnQ9Im5vcm1hbCIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1zdHJldGNoPSJub3JtYWwiIGZvbnQtc2l6ZT0iMzAzIiB0ZXh0LWFuY2hvcj0ic3RhcnQiIGRpcmVjdGlvbj0ibHRyIiB3cml0aW5nLW1vZGU9ImxyLXRiIiB1bmljb2RlLWJpZGk9Im5vcm1hbCIgdGV4dC1kZWNvcmF0aW9uPSJub25lIiB0cmFuc2Zvcm09Im1hdHJpeCgxIDAgMCAxIDE3OTQuNDIgOTY5KSI+YXNlPC90ZXh0Pjx0ZXh0IGZpbGw9IiNGRkZGRkYiIGZpbGwtb3BhY2l0eT0iMSIgZm9udC1mYW1pbHk9IkhlbHZldGljYSBOZXVlLEhlbHZldGljYSBOZXVlX01TRm9udFNlcnZpY2Usc2Fucy1zZXJpZiIgZm9udC1zdHlsZT0ibm9ybWFsIiBmb250LXZhcmlhbnQ9Im5vcm1hbCIgZm9udC13ZWlnaHQ9IjQwMCIgZm9udC1zdHJldGNoPSJub3JtYWwiIGZvbnQtc2l6ZT0iNTAiIHRleHQtYW5jaG9yPSJzdGFydCIgZGlyZWN0aW9uPSJsdHIiIHdyaXRpbmctbW9kZT0ibHItdGIiIHVuaWNvZGUtYmlkaT0ibm9ybWFsIiB0ZXh0LWRlY29yYXRpb249Im5vbmUiIHRyYW5zZm9ybT0ibWF0cml4KDAuOTQxNTA2IDAuMzM2OTk2IC0wLjMzNjk5NiAwLjk0MTUwNiA4NDYuMzU1IDgzMCkiPkFUQ0c8L3RleHQ+PC9nPjwvc3ZnPg=="
          class="markpic"> -->
        <img class="markpic" src="/images/NGSase.svg">
      </div>


      <div class="introduction-wrapper">
        <div class="introduction">
          <h2 class="introduction-title">NGSase</h2>
          <h5 class="introduction-subtitle">Next Generation Sequencing interactive Analysis</h5>
          <h6 class="introduction-content">NGSase is a versatile and user-friendly interface.It supports various NGS
            analysis software,and users can freely combine any software to make own analysis recipe.
          </h6>
        </div>
      </div>


    </div>
    <div class="login-rightside">
      <div class="wrapper">
        <div class="login-box" id="login-box">
          <h2 class="login-box-title">Login</h2>
          <form action="#" id="login-form">
            <div class="input-box">
              <label class="account-label">Account</label>
              <input class="account-input" type="email" id="login-email">
            </div>
            <div class="input-box">
              <label class="password-label">Password</label>
              <input class="password-input" type="password" id="login-password" minlength="6">
            </div>
            <div class="login-gate">
              <button type="submit" class="login-btn" id="login-btn">Login</button>
              <div class="login-status" id="login-status">Login Faild</div>
            </div>

            <div class="register">
              <p>Don't have an account?<a href="" onclick="toggleForm('register-box');return false;"
                  class="anchor">Register</a></p>
            </div>
          </form>
        </div>

        <div class="register-box" id="register-box">
          <h2 class="login-box-title">Registration</h2>
          <form action="#" id="register-form">
            <div class="input-box">
              <label class="account-label">Account</label>
              <input class="account-input" type="email" id="register-email">
            </div>
            <div class="input-box">
              <label class="password-label">Password</label>
              <input class="password-input" type="password" id="register-password" minlength="6">
            </div>
            <div class="login-gate">
              <button type="submit" class="login-btn" id="register-btn">Register</button>
              <div class="login-status" id="register-status">Register Failed</div>
            </div>

            <div class="register">
              <p>Already have an account<a href="" onclick="toggleForm('login-box');return false;"
                  class="anchor">Login</a></p>

            </div>
          </form>
        </div>
      </div>
    </div>
    <script>
      function toggleForm(formId) {
        var loginBox = document.getElementById('login-box');
        var registerBox = document.getElementById('register-box');

        if (formId === 'register-box') {
          loginBox.style.display = 'none';
          registerBox.style.display = 'block';
        } else {
          loginBox.style.display = 'block';
          registerBox.style.display = 'none';
        }
      }
      document.getElementById('login-form').addEventListener("submit", function (event) {


        event.preventDefault();

        document.getElementById("login-btn").disabled = true;
        document.getElementById("login-status").style.display = "none";
        document.getElementById("register-status").style.display = "none";
        var email = document.getElementById("login-email").value;
        var password = document.getElementById("login-password").value;

        var jsonData = {
          email: email,
          password: password
        };
        fetch("/login", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(jsonData)
        })
          .then(response => {
            if (response.ok) {
              return response.json();
            }
            else {
              throw new Error("Network response was not ok.");
            }
          })
          .then(data => {
            var loginStatus = document.getElementById("login-status");
            loginStatus.style.background = "#ffa8a8";
            loginStatus.style.color = "#bc0000";
            if (data.hasOwnProperty("message"))
              loginStatus.textContent = data.message;
            else if (data.hasOwnProperty("newURL")) {
              console.log("Login Succeed");
              loginStatus.textContent = "Login Succeed";
              loginStatus.style.background = "green";
              loginStatus.style.color = "white";
              console.log("change login succeed btn");
              window.location.replace(data.newURL);
              console.log("change URL");

            }
            else {
              console.log("into else section");
              loginStatus.textContent = "Error Occurred";
            }


            loginStatus.style.display = "block";
            document.getElementById("login-btn").disabled = false;

          })
          .catch(error => {
            console.log("catch error:", error);
            var loginStatus = document.getElementById("login-status");
            loginStatus.textContent = "Error Occurred";
            loginStatus.style.display = "block";
            document.getElementById("login-btn").disabled = false;
          })

      })

      document.getElementById('register-form').addEventListener("submit", function (event) {


        event.preventDefault();

        document.getElementById("register-btn").disabled = true;
        document.getElementById("register-status").style.display = "none";
        document.getElementById("login-status").style.display = "none";
        var email = document.getElementById("register-email").value;
        var password = document.getElementById("register-password").value;

        var jsonData = {
          email: email,
          password: password
        };
        fetch("/register", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(jsonData)
        })
          .then(response => {
            if (response.ok) {
              return response.json();
            }
            else {
              throw new Error("Network response was not ok");
            }
          })
          .then(data => {
            var registerStatus = document.getElementById("register-status");
            registerStatus.style.background = "#ffa8a8";
            registerStatus.style.color = "#bc0000";
            if (data.hasOwnProperty("message")) {

              if (data.message == "Succeed, Re-Login") {
                console.log("register succeed");
                registerStatus.textContent = data.message;
                registerStatus.style.background = "green";
                registerStatus.style.color = "white";
              }
              else {
                registerStatus.textContent = data.message;
                console.log("error occurred from mysql query");
              }
            }
            else {
              console.log("error occurred from missing json property");
              registerStatus.textContent = "Error Occurred";

            }


            registerStatus.style.display = "block";


          })
          .catch(error => {
            var registerStatus = document.getElementById("register-status");
            registerStatus.textContent = "Error Occurred";
            registerStatus.style.display = "block";
            console.log("catch error:", error);
          })
          .finally(() => {
            document.getElementById("register-btn").disabled = false;
          })
      })


    </script>
</body>
</html>